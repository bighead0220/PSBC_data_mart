/*数据回退区*/
delete from  F_ADM.a_ma_re_ma_kpi where AS_OF_DATE = '$TXDATE'::DATE;
/*数据回退区end*/

COPY F_ADM.a_ma_re_ma_kpi
(
AS_OF_DATE,
CUST_NUM,
ORG_CODE,
LOB_ID,
PROD_ID,
INDS_ID,
CUST_ACCT_NO,
ASSET_ACCT_BAL,
LIBILITY_ACCT_BAL,
ASSET_DAILY_AVG_BAL,
LIBILITY_DAILY_AVG_BAL,
OPERATING_INCM,
NET_INTEREST_INCM,
EXTNL_INTEREST_INCM,
EXTNL_INTEREST_EXPNS,
NO_INTEREST_INCM,
NO_INTEREST_EXPNS,
NO_INTEREST_NET_INCM,
I_BIZ_NET_INCM,
I_BIZ_INCM,
I_BIZ_EXPNS,
INVESTMENT_INCM,
FV_CHANGED_INCM,
EXCHANGE_INCM,
OTH_OPERATING_INCM,
NON_OPERATING_INCM,
NON_OPERATING_NET_INCM,
OPERATING_COST,
OPERATING_COST_DIR,
OPERATING_COST_TTL,
TAX_SURCHAGE,
BIZ_EXPENSES_DIR,
BIZ_EXPENSES_TTL,
DIRECT_EXPENSES,
DIRECT_EXPENSES_HR,
DIRECT_EXPENSES_MK,
DIRECT_EXPENSES_OPR,
DIRECT_EXPENSES_DPR,
DIRECT_EXPENSES_TAX,
DIRECT_EXPENSES_SRV,
DIRECT_EXPENSES_OTH,
INDIRECT_EXPENSES,
POST_EXPENSES,
ASSET_LOSS_PRVS,
OTH_OPERATING_EXPNS,
NON_OPERATING_EXPNS,
INCM_TAX,
OPERATING_PROFIT,
OPERATING_PROFIT_DIR,
OPERATING_PROFIT_TTL,
PROFIT_AMOUNT,
PROFIT_AMOUNT_DIR,
PROFIT_AMOUNT_TTL,
NET_PROFIT,
NET_PROFIT_DIR,
NET_PROFIT_TTL,
GENERATE_INT_INTEREST_NET_INCM,
GENERATE_INT_EXTNL_INTEREST_INCM,
GENERATE_INT_FTP_EXPENSE,
GENERATE_INT_ASSET_BAL,
GENERATE_INT_ASSET_AVG_BAL,
PAY_INT_NET_INCOME,
PAY_INT_FTP_INCOME,
PAY_INT_EXTNL_INTEREST_EXPNS,
PAY_INT_LIBILITY_BAL,
PAY_INT_LIBILITY_AVG_BAL,
EVA_DIR,
EVA_TTL,
CAPITAL_AMOUNT,
CAPITAL_COST,
BIZ_EXPENSES,
SYS_SRC
)
WITH SOURCE HDFS (url='http://$hadoop_namenode_id:50070/webhdfs/v1/$path2/$file_name.dat',USERNAME='$hadoop_user')
FILTER SearchAndReplace(pattern='\\',replace_with='')
DELIMITER '$delimiter' 
ENFORCELENGTH ABORT ON ERROR DIRECT

;  


